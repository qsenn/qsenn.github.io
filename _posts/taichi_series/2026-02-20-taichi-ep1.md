---
layout: post
title: "1. Setting up the Environment"
permalink: /taichi/ep1
---
As an aspiring researcher in neural physics, I've decided to start my journey with Taichi. In this post, I'll walk you through my development environment setup.


First, I needed a GPU. So I initially turned to Google Colab. However, I wasn't satisfied with the browser-based interface or the Jupyter Notebook format. I preferred using the VS Code IDE, so I tried to use Colab as a remote server via an SSH tunnel. However, I soon realized that Google restricts using their resources in this manner. Alternatively, I found that Kaggle is more flexible, so I set up my own mini-server with dual T4 GPUs using the Ngrok service.

```python
from kaggle_secrets import UserSecretsClient
import os

# Get various secret keys, tokens, etc.
user_secrets = UserSecretsClient()
SSH_LOGIN_INFO = user_secrets.get_secret("SSH_LOGIN_INFO")
NGROK_TOKEN = user_secrets.get_secret("NGROK_TOKEN")
LAPTOP_PRIVATE_KEY = user_secrets.get_secret("LAPTOP_PRIVATE_KEY")
GITHUB_USER_NAME = user_secrets.get_secret("GITHUB_USERNAME")
GITHUB_USER_EMAIL = user_secrets.get_secret("GITHUB_EMAIL")
GITHUB_TOKEN = UserSecretsClient().get_secret("GITHUB_TOKEN")

# Automated ssh authentication
!mkdir -p /root/.ssh
!echo $LAPTOP_PRIVATE_KEY >> /root/.ssh/authorized_keys
!chmod 600 /root/.ssh/authorized_keys

target_dir = "/kaggle/working/taichi"
os.makedirs(target_dir, exist_ok=True)
os.chdir(target_dir)

# Allow ssh bash shell to find paths.
with open("/root/.bashrc", "a") as f:
    f.write('\nexport PATH="/opt/bin:$PATH"')
    f.write('\nexport LD_LIBRARY_PATH="/usr/local/nvidia/lib64:$LD_LIBRARY_PATH"')
    f.write(f'\ncd {target_dir}')

# Github authentication
import os

# 1. Repository_url (for taichi)
REPOSITORY_URL = "github.com/qsenn/Taichi-playground.git"

# 2. Git user information setting
os.system(f'git config --global user.name "{GITHUB_USER_NAME}"')
os.system(f'git config --global user.email "{GITHUB_USER_EMAIL}"')

# 3. Set remote_url with my github information.
remote_url = f"https://{GITHUB_USER_NAME}:{GITHUB_TOKEN}@{REPOSITORY_URL}"

# 4. Initialize or update Git repository
if not os.path.exists('.git'):
    # If .git does not exist, initialize and connect to the remote repository.
    os.system("git init")
    os.system(f"git remote add origin {remote_url}")
    print("✅ Git repository initialized and connected.")
else:
    # If .git exists, only update url
    os.system(f"git remote set-url origin {remote_url}")
    print("✅ Git remote url updated.")

# 5. Verify remote connection
os.system("git remote -v")

# 1. Install SSH & Ngrok
!apt-get install -y openssh-server
!pip install pyngrok

# 2. Ngrok authentication (with my own token)
from pyngrok import ngrok
ngrok.set_auth_token(NGROK_TOKEN)

# 3. Set up password
!echo $SSH_LOGIN_INFO | chpasswd
!echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
!service ssh start

# 4. Opening tunnel
public_url = ngrok.connect(22, "tcp")
print(f"SSH Host Address: {public_url}")
```